import t from"vue";function e(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.addEventListener(e,i,!!n&&{capture:!1,passive:n})}function i(t,e,i){t.removeEventListener(e,i)}var n={data:function(){return{direction:""}},methods:{bindTouchEvent:function(t){var i=this.onTouchStart,n=this.onTouchMove,s=this.onTouchEnd;e(t,"touchstart",i),e(t,"touchmove",n),s&&(e(t,"touchend",s),e(t,"touchcancel",s))},touchStart:function(t){this.resetTouchStatus(),this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY},touchMove:function(t){var e,i,n,s,o=t.touches[0];this.deltaX=o.clientX<0?0:o.clientX-this.startX,this.deltaY=o.clientY-this.startY,this.direction=this.direction||(e=this.deltaX,i=this.deltaY,n=Math.abs(e),s=Math.abs(i),n>s&&n>10?"horizontal":s>n&&s>10?"vertical":"")},resetTouchStatus:function(){this.direction="",this.deltaX=0,this.deltaY=0}}};var s={data:function(){return{timer:null}},methods:{timeout:function(t,e){clearTimeout(this.timer),setTimeout((function(){"function"==typeof t&&t()}),e)}},beforeDestroy:function(){clearTimeout(this.timer)}},o=/scroll|auto/i;function r(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=t;i&&"HTML"!==i.tagName&&"BODY"!==i.tagName&&1===i.nodeType&&i!==e;){var n=window.getComputedStyle(i),s=n.overflowY;if(o.test(s))return i;i=i.parentNode}return e}var a={"zh-CN":{refresh:{pulling:"下拉刷新",loosing:"释放刷新",refresh:"正在刷新",success:"刷新完成"},loadmore:{loading:"正在加载",finished:"没有更多了",error:"请求失败，点击重新加载"}},"en-US":{refresh:{pulling:"Pull down to refresh",loosing:"Loosing to refresh",refresh:"Refreshing",success:"Refresh success"},loadmore:{loading:"Loading",finished:"No more data",error:"Request failed, click to reload"}}},l=t.prototype;(0,t.util.defineReactive)(l,"lang","zh-CN");var c={t:function(t){return function(t,e){var i=t;return e.split(".").forEach((function(t){var e;i=null!==(e=i[t])&&void 0!==e?e:""})),i}(a[l.lang],t)},use:function(t){a[t]&&(l.lang=t)}};var u=function(t,e,i,n,s,o,r,a,l,c){"boolean"!=typeof r&&(l=a,a=r,r=!1);var u,d="function"==typeof i?i.options:i;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,s&&(d.functional=!0)),n&&(d._scopeId=n),o?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=u):e&&(u=r?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),u)if(d.functional){var h=d.render;d.render=function(t,e){return u.call(e),h(t,e)}}else{var f=d.beforeCreate;d.beforeCreate=f?[].concat(f,u):[u]}return i},d={name:"loading"},h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vuejs-loading vuejs-loading-circular"},[i("span",{staticClass:"vuejs-loading-spinner vuejs-loading-spinner-circular"},[i("svg",{staticClass:"vuejs-loading-circular",attrs:{viewBox:"25 25 50 50"}},[i("circle",{attrs:{cx:"50",cy:"50",r:"20",fill:"none"}})])]),t._v(" "),i("span",{staticClass:"vuejs-loading-text"},[t._t("default")],2)])};h._withStripped=!0;var f=u({render:h,staticRenderFns:[]},undefined,d,undefined,false,undefined,!1,void 0,void 0,void 0),v=["pulling","loosing","refresh","success"],p={name:"loadmore",mixins:[n,function(t){function n(){t.call(this,e)}function s(){t.call(this,i)}return{mounted:n,activated:n,deactivated:s,beforeDestroy:s}}((function(t){var e,i,n,s,o,a,l,c;this.scroller||(this.scroller=r(this.$el)),t(this.scroller,"scroll",(e=this.checkSroll,i=200,c=function(){e.apply(a,l),s=n},function(){if(a=this,l=arguments,n=Date.now(),o&&(clearTimeout(o),o=null),s){var t=i-(n-s);t<0?c():o=setTimeout((function(){c()}),t)}else c()}))})),s],components:{Loading:f},props:{onRefresh:Function,pullingText:{type:String},loosingText:{type:String},refreshText:{type:String},successText:{type:String},showSuccessText:{type:Boolean,default:!0},pullDistance:{type:[Number,String],default:50},headHeight:{type:[Number,String],default:50},animationDuration:{type:[Number,String],default:200},onLoadmore:Function,immediateCheck:{type:Boolean,default:!1},loadOffset:{type:[Number,String],default:50},finished:Boolean,error:Boolean,loadingText:{type:String},finishedText:{type:String},errorText:{type:String}},data:function(){return{status:"normal",distance:0,duration:0,scroller:null,loadLoading:!1}},mounted:function(){this.bindTouchEvent(this.$refs.track),this.scroller=r(this.$el),this.immediateCheck&&this.checkSroll()},computed:{touchable:function(){return"refresh"!==this.status&&"success"!==this.status&&this.onRefresh},headStyle:function(){return 50!==this.headHeight?{height:"".concat(this.headHeight,"px")}:{}},genStatus:function(){var t=this.status,e=this["".concat(t,"Text")]||c.t("refresh.".concat(t));return-1!==v.indexOf(t)?e:""}},methods:{t:c.t,checkPullStart:function(t){var e,i;this.ceiling=0===(e=this.scroller,i="scrollTop"in e?e.scrollTop:e.pageYOffset,Math.max(i,0)),this.ceiling&&(this.duration=0,this.touchStart(t))},onTouchStart:function(t){this.touchable&&this.checkPullStart(t)},onTouchMove:function(t){this.touchable&&(this.ceiling||this.checkPullStart(t),this.touchMove(t),this.ceiling&&this.deltaY>=0&&"vertical"===this.direction&&(!function(t){("boolean"!=typeof t.cancelable||t.cancelable)&&t.preventDefault()}(t),this.setStatus(this.ease(this.deltaY))))},onTouchEnd:function(){var t=this;this.deltaY&&this.touchable&&(this.duration=this.animationDuration,"loosing"===this.status?(this.showRefreshTip(),this.$nextTick((function(){t.onRefresh(t.refreshDone)}))):this.setStatus(0))},ease:function(t){var e=+(this.pullDistance||this.headHeight);return t>e&&(t=t<2*e?e+(t-e)/2:1.5*e+(t-2*e)/4),Math.round(t)},setStatus:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=i?"refresh":0===t?"normal":t<(this.pullDistance||this.headHeight)?"pulling":"loosing",this.distance=t,e!==this.status&&(this.status=e)},refreshDone:function(){var t=this;this.showSuccessText?this.timeout(this.showSuccessTip,500):this.timeout((function(){return t.setStatus(0)}),500)},showRefreshTip:function(){this.setStatus(+this.headHeight,!0)},showSuccessTip:function(){var t=this;this.status="success",this.timeout((function(){return t.setStatus(0)}),1e3)},checkSroll:function(){var t=this;this.$nextTick((function(){if(!t.loadLoading&&t.onLoadmore&&!t.finished&&!t.error){var e,i=t.scroller,n=t.loadOffset;if(!((e=i.getBoundingClientRect?i.getBoundingClientRect():{top:0,bottom:i.innerHeight}).bottom-e.top))return!1;var s=t.$refs.placeholder.getBoundingClientRect();Math.abs(s.bottom-e.bottom)<=n&&(t.loadLoading=!0,t.timeout((function(){return t.onLoadmore(t.loadmoreDone)}),500))}}))},clickErrorText:function(){var t=this;this.$emit("update:error",!1),this.loadLoading=!0,this.timeout((function(){return t.onLoadmore(t.loadmoreDone)}),500)},loadmoreDone:function(){this.loadLoading=!1}}},m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vuejs-loadmore-wrap"},[i("div",{ref:"track",staticClass:"vuejs-refresh-track",style:{transform:t.distance?"translate3d(0, "+t.distance+"px, 0)":"",webkitTransform:t.distance?"translate3d(0, "+t.distance+"px, 0)":"",transitionDuration:t.duration+"ms"}},[i("div",{staticClass:"vuejs-refresh-head",style:t.headStyle},["refresh"===t.status?i("div",[i("Loading",[t._v(t._s(t.genStatus))])],1):i("div",{staticClass:"vuejs-refresh-text"},[t._v(t._s(t.genStatus))])]),t._v(" "),t._t("default"),t._v(" "),i("div",{ref:"placeholder",staticClass:"vuejs-loadmore"},[!t.loadLoading||t.finished||t.error?t._e():i("div",{staticClass:"vuejs-loadmore-loading"},[i("Loading",[t._v(t._s(t.loadingText||t.t("loadmore.loading")))])],1),t._v(" "),t.finished?i("div",{staticClass:"vuejs-loadmore-finished-text"},[t._v("\n        "+t._s(t.finishedText||t.t("loadmore.finished"))+"\n      ")]):t._e(),t._v(" "),t.error?i("div",{staticClass:"vuejs-loadmore-error-text",on:{click:t.clickErrorText}},[t._v("\n        "+t._s(t.errorText||t.t("loadmore.error"))+"\n      ")]):t._e()])],2)])};m._withStripped=!0;var g=u({render:m,staticRenderFns:[]},undefined,p,undefined,false,undefined,!1,void 0,void 0,void 0);function x(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}x(".vuejs-loadmore-wrap{-webkit-user-select:none;user-select:none}.vuejs-refresh-track{height:100%;position:relative;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;transition-property:transform;transition-property:transform,-webkit-transform}.vuejs-refresh-head{-webkit-box-pack:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;color:#646566;display:-webkit-box;display:-webkit-flex;display:flex;font-size:14px;height:50px;-webkit-justify-content:center;justify-content:center;left:0;overflow:hidden;position:absolute;text-align:center;-webkit-transform:translateY(-100%);transform:translateY(-100%);width:100%}.vuejs-loadmore{height:36px}.vuejs-loadmore-error-text,.vuejs-loadmore-finished-text,.vuejs-loadmore-loading{color:#646566;font-size:14px;line-height:36px;text-align:center}");x(".vuejs-loading{color:#323233;font-size:0}.vuejs-loading,.vuejs-loading-spinner{position:relative;vertical-align:middle}.vuejs-loading-spinner{display:inline-block;height:20px;max-height:100%;max-width:100%;width:20px}.vuejs-loading-spinner-circular{-webkit-animation-duration:2s;animation-duration:2s}.vuejs-loading-circular{display:block;height:100%;width:100%}.vuejs-loading-circular circle{stroke:currentColor;stroke-width:3;stroke-linecap:round;-webkit-animation:vuejs-circular 1.5s ease-in-out infinite;animation:vuejs-circular 1.5s ease-in-out infinite}.vuejs-loading-text{color:#646566;display:inline-block;font-size:14px;margin-left:8px;vertical-align:middle}@-webkit-keyframes vuejs-circular{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40}to{stroke-dasharray:90,150;stroke-dashoffset:-120}}@keyframes vuejs-circular{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40}to{stroke-dasharray:90,150;stroke-dashoffset:-120}}");var k={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.component("vue-loadmore",g),c.use(e.lang)}};export{k as default,c as locale};
